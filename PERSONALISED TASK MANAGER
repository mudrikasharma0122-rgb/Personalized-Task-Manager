import datetime

# Function to store user information
def user_information(username, password):
    name = input("Enter your name: ")
    address = input("Enter your address: ")
    age = input("Enter your age: ")

    filename = username + "_data.txt"

    with open(filename, 'w') as f:
        f.write(password + "\n")
        f.write("Name: " + name + "\n")
        f.write("Address: " + address + "\n")
        f.write("Age: " + age + "\n")
        f.write("\n---- TASKS ----\n")

    print("Account created successfully!\n")


# SIGNUP FUNCTION
def signup():
    print("Create your account")
    username = input("Enter a username: ")
    password = input("Enter a password: ")

    user_information(username, password)

    print("Please login to continue")
    login()


# LOGIN FUNCTION
def login():
    username = input("Enter username: ")
    entered_password = input("Enter password: ")

    filename = username + "_data.txt"

    try:
        with open(filename, 'r') as f:
            saved_password = f.readline().strip()

        if entered_password == saved_password:
            print("\nLogin successful!")
            print("1 - View profile data")
            print("2 - Add tasks")
            print("3 - Update task status")
            print("4 - View task status")

            choice = input("Choose an option: ")

            if choice == '1':
                view_data(filename)
            elif choice == '2':
                add_tasks(filename)
            elif choice == '3':
                update_task_status(username)
            elif choice == '4':
                view_task_status(username)
            else:
                print("Invalid choice")

        else:
            print("Wrong username or password! Try again.")
            login()

    except FileNotFoundError:
        print("User not found! Please signup first.")
        signup()


# VIEW USER DATA
def view_data(filename):
    with open(filename, 'r') as f:
        print("\n--- USER DATA ---")
        print(f.read())


# ADD TASKS
def add_tasks(filename):
    n = int(input("How many tasks do you want to add? "))

    with open(filename, 'a') as f:
        for i in range(1, n + 1):
            task = input(f"Enter Task {i}: ")
            target = input(f"Enter Target {i}: ")

            f.write(f"Task {i}: {task}\n")
            f.write(f"Target {i}: {target}\n")

            stop = input("Press space to stop adding tasks or Enter to continue: ")
            if stop == ' ':
                break

    print("Tasks added successfully!\n")


# UPDATE TASK STATUS
def update_task_status(username):
    filename = username + "_status.txt"

    completed = input("Enter completed tasks: ")
    not_started = input("Enter tasks not started: ")
    ongoing = input("Enter tasks in progress: ")

    with open(filename, 'a') as f:
        f.write("\n" + str(datetime.datetime.now()) + "\n")
        f.write("Completed: " + completed + "\n")
        f.write("Ongoing: " + ongoing + "\n")
        f.write("Not Started: " + not_started + "\n")

    print("Task status updated!\n")


# VIEW TASK STATUS
def view_task_status(username):
    filename = username + "_status.txt"

    try:
        with open(filename, 'r') as f:
            print("\n--- TASK STATUS ---")
            print(f.read())
    except FileNotFoundError:
        print("No task status found. Please update status first.")


# MAIN PROGRAM
if __name__ == '__main__':
    print("WELCOME TO PERSONAL TASK MANAGER")
    new_user = int(input("Are you new here? Press 1 for Yes, 0 for No: "))

    if new_user == 1:
        signup()
    elif new_user == 0:
        login()
    else:
        print("Invalid input!")

